!function(){"use strict";function t(t){t.initialize()}angular.module("app",["ui.router","ui.bootstrap","ngStorage","ngCookies","uuid4","angularMoment","luegg.directives","ngCookies","tmh.dynamicLocale","pascalprecht.translate","cfp.hotkeys"]).run(t),t.$inject=["settingssHandler"]}(),function(){"use strict";function t(t){function e(){return t}var n={getAll:e};return n}angular.module("app").factory("LocaleService",t),t.$inject=["LOCALES"]}(),function(){"use strict";angular.module("app").constant("LOCALES",["de-DE","es-ES","en-GB","en-US","fr-FR","it-IT","zh-CN","zh-TW","ja-JP","en-IN","pt-BR","ko-KR","fr-CA","en-AU","zh-HK","ar-EG","fi-FI","vpt-PT","en-NZ","pl-PL","en-CA","ru-RU","da-DK","nl-NL","ca-ES","nb-NO","es-MX","sv-SE"])}(),function(){"use strict";angular.module("app").constant("LANGUAGES",["en","fr"])}(),function(){"use strict";function t(t,e,n,i){function a(){return n}function r(){var n=t.defer(),i=e.storage().get("NG_TRANSLATE_LANG_KEY");return n.resolve(i),n.promise}function o(t){var n=t.slice(0,2);n&&(e.use(n),i.set(n))}var s={getAll:a,getCurrent:r,changeLanguage:o};return s}angular.module("app").factory("LanguageService",t),t.$inject=["$q","$translate","LANGUAGES","tmhDynamicLocale"]}(),function(){"use strict";function t(t,e,n,i){function a(){e.startListening()}function r(){return e.isListening()}function o(){return e.stopListening().then(function(e){return t.$emit("bot:listened",e),e})}function s(t){return n.predict(t)}function c(t){return i.reply(t)}function l(t){return s(t).then(c)}var u={startListening:a,isListening:r,stopListening:o,converse:l};return u}angular.module("app").factory("Bot",t),t.$inject=["$rootScope","Hears","Brain","Replies"]}(),function(){"use strict";function t(t,e,n,i,a,r,o){function s(){c(e.load());var n=t.$on("settings:saved",function(t,e){c(e)});t.$on("$destroy",function(){angular.isDefined(n)&&null!==n&&n()})}function c(t){a.changeLanguage(t.general.language),n.useLocale(t.stt.locale),n.useSpeechToText(t.stt.service),i.useNaturalLanguageProcessor(t.nlp.service),r.useSubscriptionKey(t.Luis.subscriptionKey),r.useApplication(t.Luis.application),o.useSubscriptionKey(t.BingSpeech.subscriptionKey)}return{initialize:s}}angular.module("app").factory("settingssHandler",t),t.$inject=["$rootScope","Settings","Hears","Brain","LanguageService","Luis","BingSpeech"]}(),function(){"use strict";function t(t,e,n){function i(i){return n.indexOf(t.getObject(i))===-1&&(e.info('Resetting invalid cookie language "'+t.getObject(i)+'" to prefered language "en"'),t.putObject(i,"en")),t.getObject(i)}function a(e,n){t.putObject(e,n)}return{get:i,put:a}}angular.module("app").factory("translationStorageProvider",t),t.$inject=["$cookies","$log","LANGUAGES"]}(),function(){"use strict";function t(t,e){t.setKeyPrefix("goldorak-"),e.setKeyPrefix("goldorak-")}angular.module("app").config(t),t.$inject=["$localStorageProvider","$sessionStorageProvider"]}(),function(){"use strict";function t(t,e){t.useLoader("$translatePartialLoader",{urlTemplate:"i18n/{lang}/{part}.json"}),t.preferredLanguage("en"),t.useStorage("translationStorageProvider"),t.useSanitizeValueStrategy("escaped"),t.addInterpolation("$translateMessageFormatInterpolation"),e.localeLocationPattern("i18n/angular-locale_{{locale}}.js"),e.useCookieStorage(),e.storageKey("NG_TRANSLATE_LANG_KEY")}angular.module("app").config(t),t.$inject=["$translateProvider","tmhDynamicLocaleProvider"]}(),function(){"use strict";function t(t){t.state("settings",{parent:"app",url:"/settings",templateUrl:"app/settings/settings.html",controller:"SettingsController",controllerAs:"vm",resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(t,e){return e.addPart("settings"),e.addPart("global"),t.refresh()}],locales:["LocaleService",function(t){return t.getAll()}],luisApplications:["Luis",function(t){return t.getApplications().$promise}]}})}angular.module("app").config(t),t.$inject=["$stateProvider"]}(),function(){"use strict";function t(t,e,n,i){function a(e){e=Object.assign({},s,e),t.settings=e,n.$emit("settings:saved",e)}function r(){return t.settings}var o={save:a,load:r},s=i,c=r();return c||a(s),o}angular.module("app").factory("Settings",t),t.$inject=["$localStorage","$log","$rootScope","DEFAULTS"]}(),function(){"use strict";function t(t,e,n,i,a){function r(){n.save(o.settings),e.go("home")}var o=this;o.languages=["en","fr"],o.sttEngines=[{name:"Microsoft BingSpeech",service:"BingSpeech"}],o.nlpEngines=[{name:"Microsoft Luis",service:"Luis"}],o.save=r,o.settings=n.load(),o.locales=i,o.luisApplciations=a}angular.module("app").controller("SettingsController",t),t.$inject=["$log","$state","Settings","locales","luisApplications"]}(),function(){"use strict";function t(){function t(t){return"Snowcamp: "+JSON.stringify(t)}var e={reply:t};return e}angular.module("app").factory("Snowcamp2017Replies",t),t.$inject=[]}(),function(){"use strict";function t(t){function e(t){a=t}function n(t){return a.reply(t)}var i={useReplies:e,reply:n},a=t.get("Snowcamp2017Replies");return i}angular.module("app").factory("Replies",t),t.$inject=["$injector"]}(),function(){"use strict";function t(t,e,n){function i(){var t=e.defer();return n.navigator.getUserMedia({audio:!0},function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise}function a(){i().then(function(t){c=new RecordRTC(t,{type:"audio",numberOfAudioChannels:1}),c.startRecording(),l=!0})["catch"](function(e){t.error(e)})}function r(){var t=e.defer();return c.stopRecording(function(){l=!1,t.resolve(c.getBlob())}),t.promise}function o(){return l}var s={startRecording:a,stopRecording:r,isRecording:o};n.navigator.getUserMedia=n.navigator.getUserMedia||n.navigator.webkitGetUserMedia||n.navigator.mozGetUserMedia;var c,l=!1;return s}angular.module("app").factory("Microphone",t),t.$inject=["$log","$q","$window"]}(),function(){"use strict";function t(){function t(t,n,i){function a(t){p=t}function r(t){g=t}function o(){return g}function s(){return[{name:"Conference",appId:"496aaf6a-10e6-48fa-8b17-15658ddabde2"}]}function c(n){if(!p)throw new Error("You must set the subscriptionKey first");if(!g)throw new Error("You must define at least one Luis application");i.$emit("luis:predict",{application:g,utterance:n});var a=e+"/"+g.appId+"/predict",r=[];return r.push(n),t.post(a,r,{headers:{"Ocp-Apim-Subscription-Key":p}}).then(function(t){return u(l(t))})}function l(t){if(t&&200===t.status)return t.data[0];throw new Error("Natural Language Understanding failed")}function u(t){var e={application:g,intent:t.IntentsResults[0].Name,entities:t.EntitiesResults};return i.$emit("luis:getIntent",e),e}var p,g,d={useSubscriptionKey:a,useApplication:r,getApplication:o,getApplications:s,predict:c};return d}this.$get=t;var e="https://westus.api.cognitive.microsoft.com/luis/v1.0/prog/apps";this.setLuisApiUrl=function(t){e=t},t.$inject=["$http","$log","$rootScope"]}angular.module("app").provider("Luis",t),t.$inject=[]}(),function(){"use strict";function t(t,e,n,i){function a(t){p=t,e.debug("Speech To Text Locale: "+p)}function r(t){g=t,e.debug("Speech To Text Engine: "+g)}function o(){return p}function s(){if(g)return t.get(g);throw new Error("You must define a SpeechToText engine")}function c(){i.startRecording(),n.$emit("hears:onStartListening",{sst:g,locale:p})}function l(){return n.$emit("hears:onStopListening",{sst:g,locale:p}),i.stopRecording().then(u)}function u(t){var e=s();return n.$emit("hears:onRecognize",{sst:g,locale:p,audio:t}),e.recognize(t,p)}var p,g,d={startListening:c,isListening:i.isRecording,stopListening:l,locale:o,useLocale:a,useSpeechToText:r};return d}angular.module("app").factory("Hears",t),t.$inject=["$injector","$log","$rootScope","Microphone"]}(),function(){"use strict";function t(t,e,n){function i(t){o=t,e.debug("Natural Language Processor Engine: "+o)}function a(){if(o)return t.get(o);throw new Error("You must define a NaturalLanguageProcessor engine")}function r(t){var e=a();return n.$emit("brain:onProcess",{nlp:o,text:t}),e.predict(t)}var o,s={predict:r,useNaturalLanguageProcessor:i};return s}angular.module("app").factory("Brain",t),t.$inject=["$injector","$log","$rootScope"]}(),function(){"use strict";function t(){function t(t,e,a,r,o){function s(t){d=t}function c(i,a){if(!d)throw new Error("You must set the subscriptionKey first");return t.debug("Recognizing audio with locale: "+a),p(d).then(function(t){return e.post(n+"/recognize",i,{params:{version:"3.0",requestid:o.generate(),appID:"D4D52672-91D7-4C74-8AD8-42B1D98141A5",format:"json",locale:a,"device.os":"0_0",scenarios:"ulm",instanceid:o.generate()},headers:{Authorization:"Bearer "+t,"Content-Type":"audio/wav; samplerate=44100"}})}).then(function(t){return u(l(t))})}function l(t){if(t)return t.data;throw new Error("Bing Speech recognition's reponse is empty")}function u(e){if("success"===e.header.status){var n=e.header.lexical;return t.debug("Here: "+n),n.charAt(0).toUpperCase()+n.slice(1)}throw new Error("Speech recognition failed")}function p(n){var o=r.defer(),s=a.authenticationToken,c=a.tokenExpirationDate;return s&&c>Date.now()?o.resolve(s):e.post(i,{},{headers:{"Ocp-Apim-Subscription-Key":n}}).then(function(t){s=t.data,g(s),o.resolve(s)})["catch"](function(e){t.error("Unable to authenticate the request with subscription key: "+n),o.reject(e)}),o.promise}function g(t){a.authenticationToken=t,a.tokenExpirationDate=Date.now()+54e4}var d,m={recognize:c,useSubscriptionKey:s};return m}this.$get=t;var e,n="https://speech.platform.bing.com",i="https://api.cognitive.microsoft.com/sts/v1.0/issueToken";this.useDefaultSubscriptionKey=function(t){e=t},t.$inject=["$log","$http","$localStorage","$q","uuid4"]}angular.module("app").provider("BingSpeech",t),t.$inject=[]}(),function(){"use strict";function t(t){t.state("home",{parent:"app",url:"/",templateUrl:"app/home/home.html",controller:"HomeController",controllerAs:"vm",resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(t,e){return e.addPart("home"),e.addPart("global"),t.refresh()}]}})}angular.module("app").config(t),t.$inject=["$stateProvider"]}(),function(){"use strict";function t(t,e,n,i,a,r){function o(){p.messages.push({user:"goldorak",timestamp:(new Date).getTime(),content:"home.welcome"})}function s(){r.isListening()?r.stopListening().then(c)["catch"](l):r.startListening()}function c(t){p.messages.push({user:"me",timestamp:(new Date).getTime(),content:t}),r.converse(t).then(function(t){p.messages.push({user:"goldorak",timestamp:(new Date).getTime(),content:t})})["catch"](function(t){p.messages.push({user:"goldorak",timestamp:(new Date).getTime(),content:t})})}function l(t){n.error(t),p.messages.push({user:"goldorak",timestamp:(new Date).getTime(),content:"home.stt.failed"})}function u(){p.text&&c(p.text),p.text=""}var p=this;p.toggleRecording=s,p.isRecording=r.isListening,p.submit=u,p.messages=[],a.add({combo:"ctrl+space",description:i.instant("home.hotkey"),callback:p.toggleRecording}),o()}angular.module("app").controller("HomeController",t),t.$inject=["$rootScope","$scope","$log","$translate","hotkeys","Bot"]}(),angular.module("ngLocale",[],["$provide",function(t){var e={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};t.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],ERANAMES:["avant Jésus-Christ","après Jésus-Christ"],ERAS:["av. J.-C.","ap. J.-C."],FIRSTDAYOFWEEK:0,MONTH:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],SHORTDAY:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],SHORTMONTH:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],STANDALONEMONTH:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],WEEKENDRANGE:[5,6],fullDate:"EEEE d MMMM y",longDate:"d MMMM y",medium:"d MMM y HH:mm:ss",mediumDate:"d MMM y",mediumTime:"HH:mm:ss","short":"dd/MM/y HH:mm",shortDate:"dd/MM/y",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:" ",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:" ¤",posPre:"",posSuf:" ¤"}]},id:"fr",localeID:"fr",pluralCat:function(t,n){var i=0|t;return 0==i||1==i?e.ONE:e.OTHER}})}]),angular.module("ngLocale",[],["$provide",function(t){function e(t){t+="";var e=t.indexOf(".");return e==-1?0:t.length-e-1}function n(t,n){var i=n;void 0===i&&(i=Math.min(e(t),3));var a=Math.pow(10,i),r=(t*a|0)%a;return{v:i,f:r}}var i={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};t.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],STANDALONEMONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"en",localeID:"en",pluralCat:function(t,e){var a=0|t,r=n(t,e);return 1==a&&0==r.v?i.ONE:i.OTHER}})}]),function(){"use strict";function t(t,e){e.otherwise("/"),t.state("app",{"abstract":!0,template:'<ui-view class="fill"/>',resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(t,e){return e.addPart("global"),t.refresh()}]}})}angular.module("app").config(t),t.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"use strict";angular.module("app").constant("DEFAULTS",{general:{language:"en"},stt:{name:"Microsoft BingSpeech",service:"BingSpeech",locale:"en-US"},nlp:{name:"Microsoft Luis",service:"Luis"},BingSpeech:{subscriptionKey:"8fb1a8c7b61a41d4838ddc60d84e6601"},Luis:{subscriptionKey:"ebc99ea1bfe8481d9c01f8145a553187",application:{name:"Snowcamp 2017",appId:"496aaf6a-10e6-48fa-8b17-15658ddabde2"}}})}(),angular.module("app").run(["$templateCache",function(t){t.put("app/home/home.html",'<div class="fill">\n\t<div class="container content mt-3" scroll-glue>\n\t\t<div class="row mb-2" ng-repeat="message in vm.messages">\n\t\t\t<div class="col-3 col-sm-1">\n\t\t\t\t<img class="rounded img-fluid" ng-src="content/images/{{message.user}}.png">\n\t\t\t</div>\n\t\t\t<div class="col">\n\t\t\t\t<div class="card" ng-class="message.user == \'me\' ? \'card-outline-warning\' : \'card-outline-info\'">\n\t\t\t\t\t<div class="card-block">\n\t\t\t\t\t\t<span class="card-title"><strong class="capitalize">{{message.user}}</strong></span>\n\t\t\t\t\t\t<span class="card-subtitle"><small class="ml-1 text-muted">{{message.timestamp | amDateFormat: \'HH:mm\'}}</small></span>\n\t\t\t\t\t\t<p class="card-text" translate="{{message.content}}" translate-values="{{message.values}}"></p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="container hidden-sm-down">\n\t\t<div class="row">\n\t\t\t<div class="col">\n\t\t\t\t<form ng-submit="vm.submit()">\n\t\t\t\t\t<div class="input-group">\n\t\t\t\t\t\t<span class="input-group-btn">\n\t\t\t\t\t<button type="button" ng-click="vm.toggleRecording()" class="btn btn-lg" ng-class="vm.isRecording() ? \'btn-danger\' : \'btn-success\'">\n\t\t\t\t\t\t<i class="fa fa-2x" ng-class="vm.isRecording() ? \'fa-microphone-slash\' : \'fa-microphone\'" aria-hidden="true"></i>\n\t\t\t</button>\n\t\t\t\t</span>\n\t\t\t\t\t\t<input type="text" class="form-control" ng-model="vm.text" placeholder="{{ \'home.form.placeholder\' | translate }}">\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="hidden-sm-up fixed-bottom">\n\t\t<div class="row">\n\t\t\t<div class="col">\n\t\t\t\t<form ng-submit="vm.submit()">\n\t\t\t\t\t<div class="input-group">\n\t\t\t\t\t\t<span class="input-group-btn">\n\t\t\t\t\t<button type="button" ng-click="vm.toggleRecording()" class="btn no-rounded" ng-class="vm.isRecording() ? \'btn-danger\' : \'btn-success\'">\n\t\t\t\t\t\t<i class="fa fa-2x" ng-class="vm.isRecording() ? \'fa-microphone-slash\' : \'fa-microphone\'" aria-hidden="true"></i>\n\t\t\t</button>\n\t\t\t\t</span>\n\t\t\t\t\t\t<input type="text" class="form-control no-rounded" ng-model="vm.text" placeholder="{{ \'home.form.placeholder\' | translate }}">\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\n</div>\n'),t.put("app/settings/settings.html",'<div class="container mt-3">\n  <form>\n    <h4 class="text-primary" translate="settings.general.title">General</h4>\n    <div class="form-group row">\n      <label for="language" class="col-sm-2 col-form-label" translate="settings.general.language">Language</label>\n      <div class="col-sm-10">\n        <select class="form-control" ng-model="vm.settings.general.language" ng-options="it for it in vm.languages track by it"></select>\n      </div>\n    </div>\n    <h4 class="text-primary" translate="settings.stt.title">Speach To Text</h4>\n    <div class="form-group row">\n      <label for="locale" class="col-sm-2 col-form-label" translate="settings.stt.locale">Locale</label>\n      <div class="col-sm-10">\n        <input type="text" class="form-control" id="locale" placeholder="en-US,fr-FR,.." ng-model="vm.settings.stt.locale" uib-typeahead="locale for locale in vm.locales | filter:$viewValue | limitTo:3">\n      </div>\n    </div>\n    <div class="form-group row">\n      <label for="sst_engine" class="col-sm-2 col-form-label" translate="settings.stt.engine">Engine</label>\n      <div class="col-sm-10">\n        <select class="form-control" ng-model="vm.settings.stt" ng-options="it.name for it in vm.sttEngines track by it.name"></select>\n      </div>\n    </div>\n    <h5>Microsoft BingSpeech</h5>\n    <fieldset disabled="disabled">\n      <div class="form-group row">\n        <label for="BingSpeech_subscription_key" class="col-sm-2 col-form-label" translate="settings.BingSpeech.subscriptionKey">Subscription Key</label>\n        <div class="col-sm-10">\n          <input type="text" class="form-control" id="BingSpeech_subscription_key" placeholder="The BingSpeech Subscription Key to use" ng-model="vm.settings.BingSpeech.subscriptionKey">\n        </div>\n      </div>\n    </fieldset>\n\n    <h4 class="text-primary" translate="settings.nlp.title">Natural Language Processor</h4>\n    <div class="form-group row">\n      <label for="nlp_engine" class="col-sm-2 col-form-label" translate="settings.nlp.engine">Engine</label>\n      <div class="col-sm-10">\n        <select class="form-control" ng-model="vm.settings.nlp" ng-options="it.name for it in vm.nlpEngines track by it.name"></select>\n      </div>\n    </div>\n    <h5>Microsoft Luis</h5>\n    <fieldset disabled="disabled">\n      <div class="form-group row">\n        <label for="luis_subscription_key" class="col-sm-2 col-form-label" translate="settings.Luis.subscriptionKey">Subscription Key</label>\n        <div class="col-sm-10">\n          <input type="text" class="form-control" id="luis_subscription_key" placeholder="The Luis Subscription Key to use" ng-model="vm.settings.Luis.subscriptionKey">\n        </div>\n      </div>\n    </fieldset>\n    <div class="form-group row">\n      <label for="application" class="col-sm-2 col-form-label" translate="settings.Luis.application">Application</label>\n      <div class="col-sm-10">\n        <select class="form-control" ng-model="vm.settings.Luis.application" ng-options="it.name for it in vm.luisApplciations track by it.appId"></select>\n      </div>\n    </div>\n\n\n    <div class="form-group row">\n      <div class="offset-sm-2 col-sm-10 text-right">\n        <button type="submit" class="btn btn-primary" ng-click="vm.save()"><i class="fa fa-floppy-o" aria-hidden="true"></i>&nbsp;<span translate="settings.save">Save</span></button>\n      </div>\n    </div>\n  </form>\n</div>\n')}]);
//# sourceMappingURL=../maps/scripts/app-f0185fc4ba.js.map
