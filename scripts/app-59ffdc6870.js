!function(){"use strict";angular.module("app",["ui.router","ui.bootstrap","ngStorage","ngCookies","uuid4","angularMoment","luegg.directives","ngCookies","tmh.dynamicLocale","pascalprecht.translate","cfp.hotkeys"])}(),function(){"use strict";function t(t){function e(){return t}var n={getAll:e};return n}angular.module("app").factory("LocaleService",t),t.$inject=["LOCALES"]}(),function(){"use strict";angular.module("app").constant("LOCALES",["de-DE","es-ES","en-GB","en-US","fr-FR","it-IT","zh-CN","zh-TW","ja-JP","en-IN","pt-BR","ko-KR","fr-CA","en-AU","zh-HK","ar-EG","fi-FI","vpt-PT","en-NZ","pl-PL","en-CA","ru-RU","da-DK","nl-NL","ca-ES","nb-NO","es-MX","sv-SE"])}(),function(){"use strict";angular.module("app").constant("LANGUAGES",["en","fr"])}(),function(){"use strict";function t(t,e,n,a){function r(){return n}function o(){var n=t.defer(),a=e.storage().get("NG_TRANSLATE_LANG_KEY");return n.resolve(a),n.promise}function i(t){var n=t.slice(0,2);n&&(e.use(n),a.set(n))}var s={getAll:r,getCurrent:o,changeLanguage:i};return s}angular.module("app").factory("LanguageService",t),t.$inject=["$q","$translate","LANGUAGES","tmhDynamicLocale"]}(),function(){"use strict";function t(t,e,n){function a(a){return n.indexOf(t.getObject(a))===-1&&(e.info('Resetting invalid cookie language "'+t.getObject(a)+'" to prefered language "en"'),t.putObject(a,"en")),t.getObject(a)}function r(e,n){t.putObject(e,n)}return{get:a,put:r}}angular.module("app").factory("translationStorageProvider",t),t.$inject=["$cookies","$log","LANGUAGES"]}(),function(){"use strict";function t(t,e){t.setKeyPrefix("goldorak-"),e.setKeyPrefix("goldorak-")}angular.module("app").config(t),t.$inject=["$localStorageProvider","$sessionStorageProvider"]}(),function(){"use strict";function t(t,e){t.useLoader("$translatePartialLoader",{urlTemplate:"i18n/{lang}/{part}.json"}),t.preferredLanguage("en"),t.useStorage("translationStorageProvider"),t.useSanitizeValueStrategy("escaped"),t.addInterpolation("$translateMessageFormatInterpolation"),e.localeLocationPattern("i18n/angular-locale_{{locale}}.js"),e.useCookieStorage(),e.storageKey("NG_TRANSLATE_LANG_KEY")}angular.module("app").config(t),t.$inject=["$translateProvider","tmhDynamicLocaleProvider"]}(),function(){"use strict";function t(t){t.state("settings",{parent:"app",url:"/settings",templateUrl:"app/settings/settings.html",controller:"SettingsController",controllerAs:"vm",resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(t,e){return e.addPart("settings"),e.addPart("global"),t.refresh()}],locales:["LocaleService",function(t){return t.getAll()}]}})}angular.module("app").config(t),t.$inject=["$stateProvider"]}(),function(){"use strict";function t(t,e,n,a){function r(t){t=Object.assign({},s,t),a.changeLanguage(t.stt.locale),n.settings=t}function o(){return n.settings}var i={save:r,load:o},s={stt:{locale:"en-US"}},c=o();return c||r(s),i}angular.module("app").factory("Settings",t),t.$inject=["$log","$q","$localStorage","LanguageService"]}(),function(){"use strict";function t(t,e,n,a){function r(){n.save(o.settings),e.go("home")}var o=this;o.save=r,o.settings=n.load(),o.locales=a}angular.module("app").controller("SettingsController",t),t.$inject=["$log","$state","Settings","locales"]}(),function(){"use strict";function t(t,e,n){function a(){var t=e.defer();return n.navigator.getUserMedia({audio:!0},function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise}function r(){a().then(function(t){c=new RecordRTC(t,{type:"audio",numberOfAudioChannels:1}),c.startRecording(),l=!0})["catch"](function(e){t.error(e)})}function o(){var t=e.defer();return c.stopRecording(function(){l=!1,t.resolve(c.getBlob())}),t.promise}function i(){return l}var s={startRecording:r,stopRecording:o,isRecording:i};n.navigator.getUserMedia=n.navigator.getUserMedia||n.navigator.webkitGetUserMedia||n.navigator.mozGetUserMedia;var c,l=!1;return s}angular.module("app").factory("Microphone",t),t.$inject=["$log","$q","$window"]}(),function(){"use strict";function t(t,e,n,a,r,o){function i(n,r){return t.debug("Recognizing audio with locale: "+r),l(o).then(function(t){return a.post("https://speech.platform.bing.com/recognize",n,{params:{version:"3.0",requestid:e.generate(),appID:"D4D52672-91D7-4C74-8AD8-42B1D98141A5",format:"json",locale:r,"device.os":"0_0",scenarios:"ulm",instanceid:e.generate()},headers:{Authorization:"Bearer "+t,"Content-Type":"audio/wav; samplerate=44100"}})}).then(function(t){return c(s(t))})["catch"](function(t){throw t})}function s(t){if(t)return t.data;throw new Error("Bing Speech recognition's reponse is empty")}function c(t){if("success"===t.header.status){var e=t.header.lexical;return e.charAt(0).toUpperCase()+e.slice(1)}throw new Error("Speech recognition failed")}function l(e){var i=n.defer(),s=r.authenticationToken,c=r.tokenExpirationDate;return s&&c>Date.now()?i.resolve(s):a.post("https://api.cognitive.microsoft.com/sts/v1.0/issueToken",{},{headers:{"Ocp-Apim-Subscription-Key":e}}).then(function(t){s=t.data,u(s),i.resolve(s)})["catch"](function(e){t.error("Unable to authenticate the request with subscription key: "+o),i.reject(e)}),i.promise}function u(t){r.authenticationToken=t,r.tokenExpirationDate=Date.now()+54e4}var m={recognize:i};return m}angular.module("app").factory("BingSpeech",t),t.$inject=["$log","uuid4","$q","$http","$localStorage","BING_SPEECH_SUBSCRIPTION_KEY"]}(),function(){"use strict";function t(t){t.state("home",{parent:"app",url:"/",templateUrl:"app/home/home.html",controller:"HomeController",controllerAs:"vm",resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(t,e){return e.addPart("home"),e.addPart("global"),t.refresh()}],locale:["Settings",function(t){var e=t.load();return e.stt.locale}]}})}angular.module("app").config(t),t.$inject=["$stateProvider"]}(),function(){"use strict";function t(t,e,n,a,r,o,i){function s(){g.text&&(c(g.text),g.text="")}function c(t){g.messages.push({user:"me",timestamp:(new Date).getTime(),content:t},{user:"goldorak",timestamp:(new Date).getTime(),content:"home.parrot",values:{message:t}}),"Goldorak"===t&&g.messages.push({user:"goldorak",timestamp:(new Date).getTime(),content:"Go!"})}function l(){m()?d():u()}function u(){o.startRecording()}function m(){return o.isRecording()}function d(){o.stopRecording().then(function(t){r.recognize(t,i).then(c)["catch"](function(t){e.error(t),g.messages.push({user:"goldorak",timestamp:(new Date).getTime(),content:"home.stt.failed"})})})}var g=this;g.toggleRecording=l,g.isRecording=m,g.submit=s,g.messages=[],a.add({combo:"ctrl+space",description:n.instant("home.hotkey"),callback:l}),g.messages.push({user:"goldorak",timestamp:(new Date).getTime(),content:"home.welcome"})}angular.module("app").controller("HomeController",t),t.$inject=["$scope","$log","$translate","hotkeys","BingSpeech","Microphone","locale"]}(),angular.module("ngLocale",[],["$provide",function(t){var e={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};t.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],ERANAMES:["avant Jésus-Christ","après Jésus-Christ"],ERAS:["av. J.-C.","ap. J.-C."],FIRSTDAYOFWEEK:0,MONTH:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],SHORTDAY:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],SHORTMONTH:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],STANDALONEMONTH:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],WEEKENDRANGE:[5,6],fullDate:"EEEE d MMMM y",longDate:"d MMMM y",medium:"d MMM y HH:mm:ss",mediumDate:"d MMM y",mediumTime:"HH:mm:ss","short":"dd/MM/y HH:mm",shortDate:"dd/MM/y",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:" ",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:" ¤",posPre:"",posSuf:" ¤"}]},id:"fr",localeID:"fr",pluralCat:function(t,n){var a=0|t;return 0==a||1==a?e.ONE:e.OTHER}})}]),angular.module("ngLocale",[],["$provide",function(t){function e(t){t+="";var e=t.indexOf(".");return e==-1?0:t.length-e-1}function n(t,n){var a=n;void 0===a&&(a=Math.min(e(t),3));var r=Math.pow(10,a),o=(t*r|0)%r;return{v:a,f:o}}var a={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};t.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],STANDALONEMONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"en",localeID:"en",pluralCat:function(t,e){var r=0|t,o=n(t,e);return 1==r&&0==o.v?a.ONE:a.OTHER}})}]),function(){"use strict";function t(t,e){e.otherwise("/"),t.state("app",{"abstract":!0,template:'<ui-view class="fill"/>',resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(t,e){return e.addPart("global"),t.refresh()}]}})}angular.module("app").config(t),t.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"use strict";angular.module("app").constant("BING_SPEECH_SUBSCRIPTION_KEY","8fb1a8c7b61a41d4838ddc60d84e6601")}(),angular.module("app").run(["$templateCache",function(t){t.put("app/home/home.html",'<div class="fill">\n\t<div class="container content mt-3" scroll-glue>\n\t\t<div class="row mb-2" ng-repeat="message in vm.messages">\n\t\t\t<div class="col-1">\n\t\t\t\t<img class="rounded" ng-src="content/images/{{message.user}}.png">\n\t\t\t</div>\n\t\t\t<div class="col-11">\n\t\t\t\t<div class="card" ng-class="message.user == \'me\' ? \'card-outline-warning\' : \'card-outline-info\'">\n\t\t\t\t\t<div class="card-block">\n\t\t\t\t\t\t<span class="card-title"><strong class="capitalize">{{message.user}}</strong></span>\n\t\t\t\t\t\t<span class="card-subtitle"><small class="ml-1 text-muted">{{message.timestamp | amDateFormat: \'HH:mm\'}}</small></span>\n\t\t\t\t\t\t<p class="card-text" translate="{{message.content}}" translate-values="{{message.values}}"></p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="container">\n\t\t<div class="row">\n\t\t\t<div class="col-12">\n\t\t\t\t<form ng-submit="vm.submit()">\n\t\t\t\t\t<div class="input-group">\n\t\t\t\t\t\t<span class="input-group-btn">\n\t\t\t\t\t<button type="button" ng-click="vm.toggleRecording()" class="btn btn-lg" ng-class="vm.isRecording() ? \'btn-danger\' : \'btn-success\'">\n\t\t\t\t\t\t<i class="fa fa-2x" ng-class="vm.isRecording() ? \'fa-microphone-slash\' : \'fa-microphone\'" aria-hidden="true"></i>\n\t\t\t</button>\n\t\t\t\t</span>\n\t\t\t\t\t\t<input type="text" class="form-control" ng-model="vm.text" placeholder="{{ \'home.form.placeholder\' | translate }}">\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n'),t.put("app/settings/settings.html",'<div class="container mt-3">\n  <form>\n    <h4 translate="settings.stt.title">Speech Recognition</h4>\n    <div class="form-group row">\n      <label for="locale" class="col-sm-2 col-form-label" translate="settings.stt.locale">Locale</label>\n      <div class="col-sm-10">\n        <input type="text" class="form-control" id="locale" placeholder="en-US,fr-FR,.." ng-model="vm.settings.stt.locale" uib-typeahead="locale for locale in vm.locales | filter:$viewValue | limitTo:3">\n      </div>\n    </div>\n    <div class="form-group row">\n      <div class="offset-sm-2 col-sm-10 text-right">\n        <button type="submit" class="btn btn-primary" ng-click="vm.save()"><i class="fa fa-floppy-o" aria-hidden="true"></i>&nbsp;<span translate="settings.save">Save</span></button>\n      </div>\n    </div>\n  </form>\n</div>\n')}]);
//# sourceMappingURL=../maps/scripts/app-59ffdc6870.js.map
